import{hrtime as H}from"node:process";import O from"node:path";import q from"node:fs";var Q=(t,e,o)=>{let n=O.resolve("dist","channels.json"),i={builderVersion:1,channels:t==null?void 0:t.map((a,s)=>{var r;return{name:a.name,m3u:`./${a.f_name}.m3u`,count:(r=e==null?void 0:e[s])==null?void 0:r[1]}}),epgs:o==null?void 0:o.map(a=>({name:a.name,epg:`./epg/${a.f_name}.xml`})),updated_at:new Date().getTime()};q.existsSync(O.resolve("dist"))||q.mkdirSync(O.resolve("dist")),q.writeFileSync(n,JSON.stringify(i))};import l from"node:fs";import p from"node:path";import{hrtime as Et}from"node:process";import*as Z from"opencc-js";import y from"node:path";var T=y.resolve("config"),Mt=y.join(T,"custom"),z=y.resolve("dist"),Bt=process.env.TMPL_DIR||"src/tmpl",Gt=y.join(z,"txt"),Nt=y.join(z,"epg"),Vt=y.join(z,"list"),Ut=y.join(z,"sources"),Ot=y.join(z,"tvbox"),k=y.join(z,"custom"),qt=y.join(".readme"),Jt=process.env.PUBLIC_DIR||"./.gh-pages";var D=new Date().toLocaleDateString()+" "+new Date().toLocaleTimeString(),x=Z.Converter({from:"hk",to:"cn"});var Tt=[{protocol:"https",url:"https://raw.viptv.work",frequence:"viptv.work",idc:"\u5B98\u65B9\u4E91",provider:"[viptv](https://github.com/viptv-work)"}],F=()=>{let t=Tt.map(e=>e.url);return process.env.ROLLBACK_URLS?process.env.ROLLBACK_URLS.split(",").map(e=>e.trim()).concat(["https://iptv.vodtv.cn",...t]):["https://iptv.vodtv.cn",...t]},tt=()=>{let t=process.env.CUSTOM_GITHUB_RAW_SOURCE_PROXY_URL;return t||"https://gh.con.sh/"},kt=t=>{let e=tt();return t.replace(/tvg\-logo="https:\/\/raw\.githubusercontent\.com\//g,`tvg-logo="${e}/https://raw.githubusercontent.com/`)},et=t=>!!(t.includes("ABN")||t.includes("NTD")),b=t=>{let e=t.trim().replace(/\r/g,"").split(`
`).filter(s=>!!s),o=[],n=/#EXTM3U/,i=/#EXTINF:-1([^,]*),(.*)/,a=/^([^:]+):\/\/([^/]+)/;for(let s=0;s<e.length;s++){if(n.test(e[s])){o.push(e[s]);continue}if(i.test(e[s])&&a.test(e[s+1])){o=o.concat([e[s],e[s+1]]),s++;continue}}return o},ot=t=>{var e;return((e=process.env.CLOSE_SOURCE_PROXY)==null?void 0:e.trim())==="true"?t:`${tt()}/${t}`};var J=t=>x(/\#EXTINF:-1([^,]*),(.*)/.exec(t)[2]).toLowerCase().replace(/\[([^\]]*)\]/g,"").replace(/\(([^\)]*)\)/g,"").replace(/（([^）]*)）/g,"").replace(/「([^」]+)」/g,"").replace(/\-/g,"").replace(/\@\@[0-9]*/g,"").replace(/Ⅰ/g,"").replace(/ 8m/g,"").replace(/([^\|]+)\|/g,"").replace(/([^ⅰ]+)ⅰ/g,"").replace(/([\u4e00-\u9fff]+)\s+([\u4e00-\u9fff]+)/g,"$1$2").replace(/ +/g," ").trim(),I=(t,e,o)=>{let n=J(t);o(n,e)},c=(t,e,o)=>{let n=b(kt(t)).filter(i=>!/#[^E]/.test(i));if(/#EXTM3U/.test(n[0])||n.unshift("#EXTM3U"),e==="normal"&&o)for(let i=1;i<n.length;i+=2)I(n[i],n[i+1],o);return[x(n.join(`
`)),(n.length-1)/2]},nt=(t,e)=>{let o=new Map;return{collect:(n,i)=>{if(!(t&&t(n))&&!(e&&e(i)))if(o.has(n)){let a=o.get(n);if(!a){o.set(n,[i]);return}if(!a.includes(i)){o.set(n,[...a,i]);return}}else o.set(n,[i])},result:()=>o}},L=t=>{let e=new Map,o=/\#EXTINF:-1([^,]*),(.*)/,n=/group-title="([^"]*)"/;for(let a=1;a<t.length;a+=2){let s=o.exec(t[a]),r=n.exec(s[1].trim()),m="";r?m=r[1].trim():m="Undefined",e.has(m)?e.set(m,`${e.get(m)}${s[2].trim().replace(/\s+/g,"_")},${t[a+1]}
`):e.set(m,`${s[2].trim().replace(/\s+/g,"_")},${t[a+1]}
`)}let i="";return e.forEach((a,s)=>{i+=`${s},#genre#
${a}
`}),i.substring(0,i.length-2)},It=new Map([["sn.chinamobile.com","\u4E2D\u56FD\u79FB\u52A8\u9655\u897F"],["sh.chinamobile.com","\u4E2D\u56FD\u79FB\u52A8\u4E0A\u6D77"],["hl.chinamobile.com","\u4E2D\u56FD\u79FB\u52A8\u9ED1\u9F99\u6C5F"],["js.chinamobile.com","\u4E2D\u56FD\u79FB\u52A8\u6C5F\u82CF"],["cztv.com","\u6D59\u6C5F\u5E7F\u64AD\u7535\u89C6\u96C6\u56E2"],["mobaibox.com","\u4E2D\u56FD\u79FB\u52A8\u6C5F\u82CF"],["shaoxing.com.cn","\u7ECD\u5174\u7F51"],["cztvcloud.com","\u65B0\u84DD\u4E91"],["btzx.com.cn","\u5175\u56E2\u5728\u7EBF\u7F51\u7AD9"],["hznet.tv","\u83CF\u6CFD\u7F51\u7EDC\u7535\u89C6\u53F0"],["xntv.tv","\u897F\u5B81\u7F51\u7EDC\u7535\u89C6\u53F0"],["jlntv.cn","\u5409\u6797\u5E7F\u64AD\u7535\u89C6\u53F0"],["ybtvyun.com","\u5EF6\u8FB9\u5E7F\u64AD\u7535\u89C6\u53F0"],["dxhmt.cn","\u6CB3\u5357\u5927\u8C61\u878D\u5A92\u4F53"],["hebyun.com.cn","\u5180\u4E91"],["nntv.cn","\u8001\u53CB\u7F51"],["sjzntv.cn","\u71D5\u8D75\u540D\u57CE\u7F51"],["yjtvw.com","\u9633\u6C5F\u5E7F\u64AD\u7535\u89C6\u53F0"],["amazonaws.com","\u4E9A\u9A6C\u900AAWS"],["jstv.com","\u8354\u679D\u7F51"],["sgmsw.cn","\u97F6\u5173\u6C11\u58F0\u7F51"],["grtn.cn","\u5E7F\u4E1C\u7F51\u7EDC\u5E7F\u64AD\u7535\u89C6\u53F0"],["nbs.cn","\u5357\u4EAC\u5E7F\u64AD\u7535\u89C6\u53F0"],["lsrmw.cn","\u6EA7\u6C34\u878D\u5A92\u7F51"],["zohi.tv","\u798F\u5DDE\u660E\u73E0"],["qingting.fm","\u873B\u8713FM"],["hhtv.cc","\u4E91\u5357\u7EA2\u6CB3\u53D1\u5E03"],["wsrtv.com.cn","\u6587\u5C71\u5DDE\u5E7F\u64AD\u7535\u89C6\u53F0"],["xsbnrtv.cn","\u897F\u53CC\u7248\u7EB3\u5E7F\u64AD\u7535\u89C6\u7F51"],["live.yantaitv.cn","\u70DF\u53F0\u7F51\u7EDC\u5E7F\u64AD\u7535\u89C6\u53F0"],["cgtn.com","CGTN"],["cctv.com","CCTV"],["cctvplus.com","CCTV+"],["cnr.cn","\u592E\u5E7F\u7F51"],["cmvideo.cn","\u54AA\u5495"],["douyucdn","\u6597\u9C7C"],["cri.cn","\u56FD\u9645\u5728\u7EBF"],["hndt.com","\u6CB3\u5357\u5E7F\u64AD\u7F51"],["qxndt.com","\u9ED4\u897F\u5357\u5E7F\u64AD\u7F51"],["olelive.com","\u6B27\u4E50\u5F71\u9662"],["chinashadt.com","\u5343\u57CE\u4E91\u79D1"],["aodianyun.com","\u5965\u70B9\u4E91"],["xiancity.cn","\u897F\u5B89\u7F51"],["raw.githubusercontent.com","Github Raw"]]),it=t=>{for(let[n,i]of It)if(t.includes(n))return i;let o=/([^:]+):\/\/([^/]+)/.exec(t)[2];return/^\[/.test(o)?"IPv6 \u76F4\u94FE":/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(:\d+)?$/.test(o)?"IPv4 \u76F4\u94FE":o},P=t=>Array.isArray(t)?t.map(e=>{if(typeof e=="string")return e.trim();if(typeof e=="object")return P(e)}):typeof t=="object"?Object.fromEntries(Object.entries(t).map(([e,o])=>{if(typeof o=="string")return[e,o.trim()];if(typeof o=="object")return[e,P(o)]})):typeof t=="string"?t.trim():t;var M=async t=>{let e=Et.bigint(),o=/^https:\/\/raw.githubusercontent.com\//.test(t.url)?ot(t.url):t.url,n=await fetch(o);return[n.ok,await n.text(),e]},X=(t,e)=>{l.existsSync(p.join(p.resolve(),"dist"))||l.mkdirSync(p.join(p.resolve(),"dist")),l.writeFileSync(p.join(p.resolve(),"dist",`${t}.m3u`),e)},at=(t,e,o)=>{let n={};for(let[i,a]of o)n[i]=a;l.existsSync(p.resolve("dist","sources"))||l.mkdirSync(p.resolve("dist","sources")),l.writeFileSync(p.resolve("dist","sources",`${e}.json`),JSON.stringify({name:t,sources:n}))},K=(t,e,o)=>{let n=o.split(`
`),i=L(n);l.existsSync(p.join(p.resolve(),"dist","txt"))||l.mkdirSync(p.join(p.resolve(),"dist","txt")),l.writeFileSync(p.join(p.resolve(),"dist","txt",`${e}.txt`),i)},st=()=>{let t=p.resolve("dist","txt"),o=l.readdirSync(t).map(n=>l.readFileSync(p.join(t,n).toString())).join(`
`);l.writeFileSync(p.join(t,"merged.txt"),o)},mt=()=>{let t=p.resolve("dist","sources"),e=l.readdirSync(t),o={name:"Sources",sources:{}};e.forEach(n=>{let i=JSON.parse(l.readFileSync(p.join(t,n),"utf-8")).sources;Object.keys(i).forEach(a=>{o.sources[a]?o.sources[a]=[...new Set([...o.sources[a],...i[a]])]:o.sources[a]=i[a]})}),l.writeFileSync(p.join(t,"sources.json"),JSON.stringify(o))},B=(t,e)=>{l.existsSync(p.join(p.resolve(),"dist","epg"))||l.mkdirSync(p.join(p.resolve(),"dist","epg")),l.writeFileSync(p.resolve("dist","epg",`${t}.xml`),e)},G=(t,e)=>{l.existsSync(p.join(p.resolve(),"dist","movie"))||l.mkdirSync(p.join(p.resolve(),"dist","movie")),l.writeFileSync(p.resolve("dist","movie",`${t}`),e)},rt=t=>{l.existsSync(t)&&l.readdirSync(t).forEach(e=>{l.statSync(p.join(t,e)).isDirectory()?rt(p.join(t,e)):l.unlinkSync(p.join(t,e))})},$t=(t,e,o)=>{let n=(i,a)=>{l.readdir(i,(s,r)=>{if(s){o(s);return}r.forEach(m=>{let u=p.resolve(i,m);l.stat(u,(v,d)=>{if(v)o(v);else{let h=p.resolve(i,m),S=p.resolve(a,m);d.isFile()?l.createReadStream(h).pipe(l.createWriteStream(S)):d.isDirectory()&&(l.mkdirSync(S,{recursive:!0}),n(h,S))}})})})};l.access(e,i=>{i&&l.mkdirSync(e,{recursive:!0}),n(t,e)})},pt=()=>rt(p.join(p.resolve(),"dist")),ct=()=>$t(p.join(p.resolve(),"src/public"),p.join(p.resolve(),"dist"),()=>{});import g from"node:fs";import f from"node:path";var W=(t,e,o,n=!1)=>{let i=f.join(f.resolve(),"src/tmpl/LIST.tmpl.md"),a=g.readFileSync(i,"utf8").toString(),s=b(o),r=/\#EXTINF:-1([^,]*),(.*)/,m=1,u=[];for(;m<s.length;){let h=r.exec(s[m]);u.push([h[2].replace(/\|/g,"").trim(),it(s[m+1]),s[m+1]]),m+=2}let v=a.replace("{list_title}",`# List for **${t}**${n?"(Rollback)":""}

> M3U: [${e}.m3u](./${e}.m3u ), TXT: [${e}.txt](./txt/${e}.txt )`).replace("{update_channels}",`${u==null?void 0:u.map((h,S)=>`| ${S+1} | ${h[0].replace("|","")} | ${h[1]} | <${h[2]}> |`).join(`
`)}

Updated at **${D}**`),d=f.join(f.resolve(),"dist","list");g.existsSync(d)||g.mkdirSync(d),g.writeFileSync(f.join(d,`${e}.list.md`),v)},lt=(t,e,o,n)=>{let i=f.join(f.resolve(),"src/tmpl/README.tmpl.md"),s=g.readFileSync(i,"utf8").toString().replace("{update_channels}",`${t==null?void 0:t.map((r,m)=>{var u,v;return`| ${r.name} | [${r.f_name}.m3u](./${r.f_name}.m3u ) <br> [${r.f_name}.txt](./txt/${r.f_name}.txt ) | [List for ${r.name}](./list/${r.f_name}.list ) | ${((u=e==null?void 0:e[m])==null?void 0:u[1])===void 0?"update failed":e[m][1]} | ${((v=e==null?void 0:e[m])==null?void 0:v[0])==="rollback"?"\u2705":"-"} |`}).join(`
`)}

 > Updated at **${D}**`).replace("{update_epgs}",`${o==null?void 0:o.map((r,m)=>{var u,v;return`| ${r.name} | [${r.f_name}.xml](./epg/${r.f_name}.xml ) | ${(u=n==null?void 0:n[m])!=null&&u[0]?((v=n==null?void 0:n[m])==null?void 0:v[0])==="rollback"?"\u2705":"-":"update failed"} |`}).join(`
`)}

 > Updated at **${D}**`);g.existsSync(f.join(f.resolve(),"dist"))||g.mkdirSync(f.join(f.resolve(),"dist")),g.writeFileSync(f.join(f.resolve(),"dist","README.md"),s),g.writeFileSync(f.join(f.resolve(),"README.md"),s)};var _=(t,e,o)=>{let n=b(t),i=/\#EXTINF:-1\s+tvg\-name\=\"([^"]+)\"/,a=1,s=[],r=[n[0]];for(;a<n.length;){let m=i.exec(n[a]);m&&(e==="normal"&&o&&I(n[a],n[a+1],o),s.includes(m[1])||(s.push(m[1]),r.push(n[a].replace(/\@\@[0-9]*/g,"").replace(/\[geo\-blocked\]/,"").replace(/\[Geo\-blocked\]/,"").trim()),r.push(n[a+1]))),a+=2}return[x(r.join(`
`)),(r.length-1)/2]},ut=[{name:"epg.pw \u592E\u89C6",f_name:"ew_cc",url:"https://epg.pw/test_channels_china_national.m3u",filter:_},{name:"epg.pw \u536B\u89C6",f_name:"ew_ws",url:"https://epg.pw/test_channels_china_province.m3u",filter:_},{name:"epg.pw \u56FD\u5185",f_name:"ew_cn",url:"https://epg.pw/test_channels_china.m3u",filter:_},{name:"epg.pw \u9999\u6E2F",f_name:"ew_hk",url:"https://epg.pw/test_channels_hong_kong.m3u",filter:_},{name:"epg.pw \u6FB3\u9580",f_name:"ew_om",url:"https://epg.pw/test_channels_macau.m3u",filter:_},{name:"epg.pw \u53F0\u7063",f_name:"ew_tw",url:"https://epg.pw/test_channels_taiwan.m3u",filter:_},{name:"epg.pw \u5168\u90E8",f_name:"ew_all",url:"https://epg.pw/test_channels_all.m3u",filter:_},{name:"epg.pw ipv6",f_name:"ew_all",url:"https://epg.pw/test_channels_ipv6.m3u",filter:_}];var E=(t,e,o)=>{let n=b(t),i=/\#EXTVLCOPT:/,a=n.filter(m=>!i.test(m)),s=[],r=[a[0]];for(let m=1;m<a.length;m+=2){let u=J(a[m]);et(u.trim())||(e==="normal"&&o&&I(a[m],a[m+1],o),s.includes(u)||(s.push(u),r.push(a[m].replace(/\@\@[0-9]*/g,"").replace(/\[geo\-blocked\]/,"").replace(/\[Geo\-blocked\]/,"").trim()),r.push(a[m+1])))}return[x(r.join(`
`)),(r.length-1)/2]},ft=[{name:"iptv.org China",f_name:"o_cn",url:"https://raw.githubusercontent.com/iptv-org/iptv/gh-pages/countries/cn.m3u",filter:E}],vt=[{name:"iptv.org stream China",f_name:"o_s_cn",url:"https://raw.githubusercontent.com/iptv-org/iptv/master/streams/cn.m3u",filter:E},{name:"iptv.org stream China 112114",f_name:"o_s_cn_112114",url:"https://raw.githubusercontent.com/iptv-org/iptv/master/streams/cn_112114.m3u",filter:E},{name:"iptv.org stream China CCTV",f_name:"o_s_cn_cctv",url:"https://raw.githubusercontent.com/iptv-org/iptv/master/streams/cn_cctv.m3u",filter:E},{name:"iptv.org stream China CGTN",f_name:"o_s_cn_cgtn",url:"https://raw.githubusercontent.com/iptv-org/iptv/master/streams/cn_cgtn.m3u",filter:E}];var dt=[{name:"YanG-1989 Gather",f_name:"y_g",url:"https://raw.githubusercontent.com/YanG-1989/m3u/main/Gather.m3u",filter:c},{name:"\u718A\u732B\u76F4\u64AD",f_name:"xiongmao",url:"https://raw.githubusercontent.com/huangsuming/iptv/main/list/ipanda.txt",filter:c},{name:"HBv4",f_name:"hbv4",url:"https://raw.githubusercontent.com/huangsuming/iptv/main/list/hbv4.txt",filter:c},{name:"HBv6",f_name:"hbv6",url:"https://raw.githubusercontent.com/huangsuming/iptv/main/list/hbv4.txt",filter:c}];var ht=[{name:"YueChan-Live IPTV",f_name:"ycl_iptv",url:"https://raw.githubusercontent.com/YueChan/Live/main/IPTV.m3u",filter:c}];var yt=[{name:"fanmingming/live demo",f_name:"fmml_demo",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/demo.m3u",filter:c},{name:"fanmingming/live ipv6",f_name:"fmml_ipv6",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/ipv6.m3u",filter:c},{name:"fanmingming/live ipv6plus",f_name:"fmml_ipv6plus",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/ipv6plus.m3u",filter:c},{name:"fanmingming/live domainv6(Invalid)",f_name:"fmml_bst",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/Invalid/bst.m3u",filter:c},{name:"fanmingming/live domainv6(Invalid)",f_name:"fmml_cbn",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/Invalid/cbn.m3u",filter:c},{name:"fanmingming/live domainv6(Invalid)",f_name:"fmml_dv6",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/Invalid/domainv6.m3u",filter:c},{name:"fanmingming/live domainv6(Invalid)",f_name:"fmml_ipv6",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/Invalid/ipv6.m3u",filter:c},{name:"fanmingming/live domainv6(Invalid)",f_name:"fmml_ysp",url:"https://raw.githubusercontent.com/fanmingming/live/main/tv/m3u/Invalid/ysp.m3u",filter:c}];var zt=[{name:"\u5317\u4EAC\u8054\u901A \u5355\u64AD\u5217\u8868",f_name:"q_bj_iptv_unicom",url:"https://cdn.jsdelivr.net/gh/qwerttvv/Beijing-IPTV@master/IPTV-Unicom.m3u",filter:c},{name:"\u5317\u4EAC\u8054\u901A \u7EC4\u64AD\u5217\u8868",f_name:"q_bj_iptv_unicom_m",url:"https://cdn.jsdelivr.net/gh/qwerttvv/Beijing-IPTV@master/IPTV-Unicom-Multicast.m3u",filter:c},{name:"\u5317\u4EAC\u79FB\u52A8 \u5355\u64AD\u5217\u8868",f_name:"q_bj_iptv_mobile",url:"https://cdn.jsdelivr.net/gh/qwerttvv/Beijing-IPTV@master/IPTV-Mobile.m3u",filter:c},{name:"\u5317\u4EAC\u79FB\u52A8 \u7EC4\u64AD\u5217\u8868",f_name:"q_bj_iptv_mobile_m",url:"https://cdn.jsdelivr.net/gh/qwerttvv/Beijing-IPTV@master/IPTV-Mobile-Multicast.m3u",filter:c}];var gt=[{name:"joevess/IPTV home",f_name:"j_main_home",url:"https://raw.githubusercontent.com/joevess/IPTV/main/home.m3u8",filter:c},{name:"joevess/IPTV iptv",f_name:"j_main_iptv",url:"https://raw.githubusercontent.com/joevess/IPTV/main/iptv.m3u8",filter:c},{name:"joevess/IPTV sources",f_name:"j_sources_home",url:"https://raw.githubusercontent.com/joevess/IPTV/main/sources/home_sources.m3u",filter:c},{name:"joevess/IPTV iptv",f_name:"j_sources_iptv",url:"https://raw.githubusercontent.com/joevess/IPTV/main/sources/iptv_sources.m3u",filter:c},{name:"joevess/IPTV sources",f_name:"j_m3u_home",url:"https://raw.githubusercontent.com/joevess/IPTV/main/m3u/home.m3u",filter:c},{name:"joevess/IPTV iptv",f_name:"j_m3u_iptv",url:"https://raw.githubusercontent.com/joevess/IPTV/main/m3u/iptv.m3u",filter:c}];var jt=[{name:"\u5168\u56FD \u9152\u5E97\u7EC4\u64AD\u6E90",f_name:"ss_itv",url:"https://cdn.jsdelivr.net/gh/ssili126/tv@main/itvlist.m3u",filter:c}];var _t=[{name:"adultiptv.net",f_name:"adultiptv_chs",url:"http://adultiptv.net/chs.m3u",filter:c},{name:"adultiptv.net",f_name:"adultiptv_all",url:"http://adultiptv.net/all.m3u",filter:c},{name:"vbskycn/iptv",f_name:"vbskycn_ipv4",url:"https://live.zhoujie218.top/tv/iptv4.m3u",filter:c},{name:"vbskycn/iptv",f_name:"vbskycn_ipv6",url:"https://live.zhoujie218.top/tv/iptv6.m3u",filter:c},{name:"hujingguang/ChinaIPTV",f_name:"hujingguang_cnTV_AutoUpdate",url:"https://raw.githubusercontent.com/hujingguang/ChinaIPTV/main/cnTV_AutoUpdate.m3u8",filter:c}];var bt=[{name:"\u7A33\u5B9A \u6700\u65B0\u6E90",f_name:"hc_cntv",url:"https://cdn.jsdelivr.net/gh/hujingguang/ChinaIPTV@main/cnTV_AutoUpdate.m3u8",filter:c}];var $=[..._t,...yt,...ht,...dt,...gt,...ft,...vt,...ut,...zt,...jt,...bt];import{hrtime as w}from"node:process";var N=async(t,e,o=0)=>{let n=F();try{let i=w.bigint(),a=await fetch(`${n[o]}/${t.f_name}.m3u`);if(a.ok){console.log(`Fetch m3u from ${t.name} with ROLLBACK from ${n[o]} finished, cost ${(parseInt(w.bigint().toString())-parseInt(i.toString()))/1e7} ms`);let s=await a.text();return e(s,"rollback")}if(console.log(`Fetch m3u Rollback from ${n[o]} FAILED, try next...`),++o<n.length)return N(t,e,o);console.log(`All failed, give up ${t.name}!`);return}catch{if(console.log(`Fetch m3u Rollback from ${n[o]} FAILED, try next...`),++o<n.length)return N(t,e,o);console.log(`All failed, give up ${t.name}!`);return}},A=async(t,e=0)=>{let o=F();try{let n=w.bigint(),i=await fetch(`${o[e]}/${t.f_name}.xml`);if(i.ok)return console.log(`Fetch EPG from ${t.name} with ROLLBACK from ${o[e]} finished, cost ${(parseInt(w.bigint().toString())-parseInt(n.toString()))/1e7} ms`),await i.text();if(console.log(`Fetch EPG Rollback from ${o[e]} FAILED, try next...`),++e<o.length)return A(t,e);console.log(`All failed, give up ${t.name}!`);return}catch{if(console.log(`Fetch EPG Rollback from ${o[e]} FAILED, try next...`),++e<o.length)return A(t,e);console.log(`All failed, give up ${t.name}!`);return}},R=async(t,e=0)=>{let o=F();try{let n=w.bigint(),i=await fetch(`${o[e]}/data/${t.f_name}`);if(i.ok)return console.log(`Fetch DATA from ${t.name} with ROLLBACK from ${o[e]} finished, cost ${(parseInt(w.bigint().toString())-parseInt(n.toString()))/1e7} ms`),await i.text();if(console.log(`Fetch DATA Rollback from ${o[e]} FAILED, try next...`),++e<o.length)return R(t,e);console.log(`All failed, give up ${t.name}!`);return}catch{if(console.log(`Fetch DATA Rollback from ${o[e]} FAILED, try next...`),++e<o.length)return R(t,e);console.log(`All failed, give up ${t.name}!`);return}};var V=[{name:"EPG\u63A5\u53E31",f_name:"fmml",url:"https://raw.githubusercontent.com/fanmingming/live/main/e.xml"},{name:"EPG\u63A5\u53E32",f_name:"51zmt",url:"http://epg.51zmt.top:8000/e.xml"},{name:"EPG\u63A5\u53E33",f_name:"51zmt_cc",url:"http://epg.51zmt.top:8000/cc.xml"},{name:"EPG\u63A5\u53E34",f_name:"51zmt_df",url:"http://epg.51zmt.top:8000/difang.xml"}];var xt=[{name:"\u5F39\u5E55\u5E93\u63A5\u53E3",f_name:"artdm-1.xml",url:"https://gcore.jsdelivr.net/gh/zhw2590582/assets-cdn@master/danmuku/one-more-time-one-more-chance.xml"},{name:"\u5F39\u5E55\u5E93\u63A5\u53E3",f_name:"artdm-2.xml",url:"https://gcore.jsdelivr.net/gh/zhw2590582/assets-cdn@master/danmuku/your-name.xml"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-6.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=6"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-7.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=7"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-8.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=8"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-9.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=9"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-10.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=10"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-11.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=11"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-12.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=12"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-13.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=13"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-14.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=14"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-15.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=15"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv ",f_name:"lzzy-16.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=16"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv ",f_name:"lzzy-23.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=23"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv ",f_name:"lzzy-24.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=24"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-25.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=25"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-26.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=26"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-27.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=27"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-28.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=28"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-29.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=29"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-30.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=30"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-31.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=31"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-32.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=32"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-33.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=33"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-34.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=34"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-37.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=37"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-38.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=38"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-39.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=39"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-40.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=40"},{name:"\u91CF\u5B50\u8D44\u6E90-lzzy.tv",f_name:"lzzy-46.json",url:"http://cj.lziapi.com/api.php/provide/vod/from/lzm3u8/at/json/?ac=videolist&t=46"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-49.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=49"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-50.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=50"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-54.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=54"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-64.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=64"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-67.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=67"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-66.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=66"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-68.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=68"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-69.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=69"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-29.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=29"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-30.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=30"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-56.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=56"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-57.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=57"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-58.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=58"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-59.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=59"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-25.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=25"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-26.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=26"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-27.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=27"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-6.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=6"},{name:"\u7D22\u5C3C\u8D44\u6E90 - suonizy.com",f_name:"snzy-7.json",url:"https://suoniapi.com/api.php/provide/vod/from/snm3u8/at/json/?ac=videolist&t=7"},{name:"\u9B54\u90FD\u8D44\u6E90 - moduzy.net",f_name:"mdzy-1.json",url:"https://www.mdzyapi.com/api.php/provide/vod/from/modum3u8/at/json?ac=videolist&t=1"},{name:"\u9B54\u90FD\u8D44\u6E90 - moduzy.net",f_name:"mdzy-2.json",url:"https://www.mdzyapi.com/api.php/provide/vod/from/modum3u8/at/json?ac=videolist&t=2"},{name:"\u9B54\u90FD\u8D44\u6E90 - moduzy.net",f_name:"mdzy-3.json",url:"https://www.mdzyapi.com/api.php/provide/vod/from/modum3u8/at/json?ac=videolist&t=3"},{name:"\u9B54\u90FD\u8D44\u6E90 - moduzy.net",f_name:"mdzy-4.json",url:"https://www.mdzyapi.com/api.php/provide/vod/from/modum3u8/at/json?ac=videolist&t=4"},{name:"\u9B54\u90FD\u8D44\u6E90 - moduzy.net",f_name:"mdzy-5.json",url:"https://www.mdzyapi.com/api.php/provide/vod/from/modum3u8/at/json?ac=videolist&t=5"},{name:"\u9B54\u90FD\u8D44\u6E90 - moduzy.net",f_name:"mdzy-6.json",url:"https://www.mdzyapi.com/api.php/provide/vod/from/modum3u8/at/json?ac=videolist&t=6"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-6.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=6"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-7.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=7"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-8.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=8"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-9.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=9"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-10.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=10"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-11.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=11"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-12.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=12"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-20.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=20"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-13.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=13"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-14.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=14"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-15.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=15"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-16.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=16"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-17.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=17"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-18.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=18"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-25.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=25"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-26.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=26"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-27.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=27"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-28.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=28"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-49.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=49"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-50.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=50"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-54.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=54"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-63.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=63"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-64.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=64"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-65.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=65"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-66.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=66"},{name:"\u9C7C\u4E50\u8D44\u6E90- ylzy[11-20].com",f_name:"ylzy-67.json",url:"https://api.ylzy.me/api.php/provide/vod/?ac=videolist&t=67"},{name:"\u7F8E\u5973\u5C0F\u59D0\u59D0",f_name:"ks.txt",url:"https://v.591meta.com/ks.txt"},{name:"\u7F8E\u5973\u5C0F\u59D0\u59D0",f_name:"ks-xjj.txt",url:"https://gcore.jsdelivr.net/gh/maintell/xjj@master/video/ks.txt"},{name:"tiktok\u5C0F\u59D0\u59D0",f_name:"tiktok.txt",url:"https://gcore.jsdelivr.net/gh/maintell/xjj@master/video/tiktok.txt"},{name:"\u8DF3\u821E\u5C0F\u59D0\u59D0",f_name:"ks-dance.txt",url:"https://gcore.jsdelivr.net/gh/maintell/xjj@master/video/ks.dance.txt"},{name:"\u5FEB\u624B\u5C0F\u59D0\u59D0",f_name:"ks-meinv.txt",url:"https://gcore.jsdelivr.net/gh/maintell/xjj@master/video/ks.meinv.txt"},{name:"\u7F8E\u817F\u5C0F\u59D0\u59D0",f_name:"ks-meitui.txt",url:"https://gcore.jsdelivr.net/gh/maintell/xjj@master/video/ks.meitui.txt"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-31.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=31"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-32.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=32"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv ",f_name:"bfzy-33.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=33"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-34.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=34"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-35.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=35"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-36.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=36"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-37.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=37"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-38.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=38"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-40.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=40"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-41.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=41"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-42.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=42"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-43.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=43"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-44.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=44"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-46.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=46"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-47.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=47"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-48.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=48"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-49.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=49"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-21.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=21"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-22.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=22"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-23.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=23"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-24.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=24"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-25.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=25"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-26.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=26"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-27.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=27"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-54.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=54"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-55.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=55"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-57.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=57"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-59.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=59"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-60.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=60"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-61.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=61"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-62.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=62"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-63.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=63"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-64.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=64"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-65.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=65"},{name:"\u66B4\u98CE\u8D44\u6E90-bfzy.tv",f_name:"bfzy-66.json",url:"https://bfzyapi.com/api.php/provide/vod/from/bfzym3u8/at/json/?ac=videolist&t=66"},{name:"\u864E\u7259\u76F4\u64AD",f_name:"huya.txt",url:"https://pastebin.com/raw/cxpKT8Mw"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-1.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=1"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-2.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=2"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-3.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=3"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-4.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=4"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-5.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=5"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-6.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=6"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-7.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=7"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-8.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=8"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-9.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=9"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-10.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=10"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-20.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=20"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-21.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=21"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-22.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=22"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-23.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=23"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-24.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=24"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-25.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=25"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-26.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=26"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-27.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=27"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-28.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=28"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-29.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=29"},{name:"\u9EBB\u8C46\u89C6\u9891-91md.me",f_name:"mdsp-30.json",url:"https://cors.eu.org/http://md91.cc/api.php/provide/vod/from/mdm3u8/at/json?ac=videolist&t=30"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-5.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=5"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-6.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=6"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-7.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=7"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-8.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=8"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-9.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=9"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-10.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=10"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-11.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=11"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-12.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=12"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-13.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=13"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-14.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=14"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-15.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=15"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-16.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=16"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-17.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=17"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-18.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=18"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-19.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=19"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-62.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=62"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-63.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=63"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-64.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=64"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-65.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=65"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-66.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=66"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-67.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=67"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-68.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=68"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-69.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=69"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-70.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=70"},{name:"\u4F18\u8D28\u8D44\u6E90-api.1080zyku.com",f_name:"yzzy-83.json",url:"https://api.1080zyku.com/inc/apijson.php?ac=videolist&t=83"},{name:"xgsp.tv",f_name:"xgsp-girls.json",url:"https://zh.xgsp.tv/api/front/models?limit=60&offset=0&primaryTag=girls&filterGroupTags=%5B%5B%22autoTagNew%22%5D%5D&sortBy=trending&parentTag=autoTagNew&userRole=guest&groupId=9&uniq=re6jctvzay4ok2gp"},{name:"xgsp.tv",f_name:"xgsp-couples.json",url:"https://zh.xgsp.tv/api/front/models?limit=60&offset=0&primaryTag=couples&filterGroupTags=%5B%5B%22autoTagNew%22%5D%5D&sortBy=trending&parentTag=autoTagNew&userRole=guest&groupId=9&uniq=gav5eqwy8kfiz4to"},{name:"xgsp.tv",f_name:"xgsp-man.json",url:"https://zh.xgsp.tv/api/front/models?limit=60&offset=0&primaryTag=men&filterGroupTags=%5B%5B%22autoTagNew%22%5D%5D&sortBy=trending&parentTag=autoTagNew&userRole=guest&groupId=9&uniq=gzf5db2v68wn7yls"},{name:"xgsp.tv",f_name:"xgsp-trans.json",url:"https://zh.xgsp.tv/api/front/models?limit=60&offset=0&primaryTag=trans&filterGroupTags=%5B%5B%22autoTagNew%22%5D%5D&sortBy=trending&parentTag=autoTagNew&userRole=guest&groupId=9&uniq=tezacdfq1mlrhkx7"}];import Y from"node:fs";import wt from"node:path";var At=(t,e)=>{if(t.length<1)throw new Error("No sources for tvbox found!");let o={lives:[]},n={group:e||t[0].name,channels:t.map(({name:i,f_name:a})=>({name:i,urls:[`./txt/${a}.txt`]}))};return o.lives.push(n),o},U=(t,e,o)=>{let n=wt.resolve("dist","tvbox");Y.existsSync(n)||Y.mkdirSync(n),Y.writeFileSync(wt.join(n,`/${t}.json`),JSON.stringify(At(e,o)))};import j from"node:fs";import C from"node:path";var Rt=()=>{if(!j.existsSync(T)||j.readdirSync(T).length===0)return;let t=JSON.parse(j.readFileSync(C.join(T,"custom.json"),"utf-8"));return t.rules=P(t.rules),t},Ct=()=>j.readdirSync(C.join(z,"txt")).map(t=>t.replace(".txt","")).filter(t=>t!=="channels"),St=()=>{let t=Rt();if(!t||!t.rules||t.rules.length===0)return;j.existsSync(k)||j.mkdirSync(k);let e=Ct(),o=t.rules.filter(i=>e.includes(i.upstream.trim())),n=o.map(i=>i.upstream);e.forEach(i=>{if(!n.includes(i))return;let a=o.filter(m=>m.upstream===i);if(a.length===0)return;console.log(`Customize Source ${i}`);let s=j.readFileSync(C.join(z,`${i}.m3u`),"utf-8").split(`
`),r=[s[0]];a.forEach(m=>{for(let u=1;u<s.length;u+=2){let d=/\#EXTINF:-1([^,]*),(.*)/.exec(s[u])[2].trim();m.include&&Array.isArray(m.include)?m.include.includes(d)&&(r.push(s[u]),r.push(s[u+1])):m.exclude&&Array.isArray(m.exclude)&&m.exclude.includes(d)||(r.push(s[u]),r.push(s[u+1]))}m.append&&Array.isArray(m.append)&&m.append.forEach(({name:u,url:v,extinf:d})=>{if(d)r.push(d);else{let h=u.trim();r.push(`#EXTINF:-1 tvg-name="${h}" tvg-id="${h}" group-title="Custom",${h}`)}r.push(v)})}),j.writeFileSync(C.join(k,`${i}.m3u`),r.join(`
`)),j.writeFileSync(C.join(k,`${i}.txt`),L(r))})};pt();ct();Promise.allSettled($.map(async t=>{console.log(`[TASK] Fetch ${t.name}`);try{let[e,o,n]=await M(t);if(e&&o){console.log(`Fetch m3u from ${t.name} finished, cost ${(parseInt(H.bigint().toString())-parseInt(n.toString()))/1e7} ms`);let i=nt(void 0,r=>!/^([a-z]+)\:\/\//.test(r)),[a,s]=t.filter(o,["o_all","all"].includes(t.f_name)?"skip":"normal",i.collect);return X(t.f_name,a),K(t.name,t.f_name,a),at(t.name,t.f_name,i.result()),U(t.f_name,[{name:t.name,f_name:t.f_name}],t.name),W(t.name,t.f_name,a),["normal",s]}else return}catch{let o=await N(t,t.filter);if(o){let[n,i]=o;return X(t.f_name,n),K(t.name,t.f_name,n),U(t.f_name,[{name:t.name,f_name:t.f_name}],t.name),W(t.name,t.f_name,n),["rollback",i]}else return["rollback",void 0]}})).then(async t=>{let e=await Promise.allSettled(V.map(async o=>{console.log(`[TASK] Fetch EPG ${o.name}`);try{let[n,i,a]=await M(o);if(n&&i)return console.log(`Fetch EPG from ${o.name} finished, cost ${(parseInt(H.bigint().toString())-parseInt(a.toString()))/1e7} ms`),B(o.f_name,i),["normal"];{let s=await A(o);return s?(B(o.f_name,s),["rollback"]):(console.log(`[WARNING] EPG ${o.name} get failed!`),[void 0])}}catch{let i=await A(o);return i?(B(o.f_name,i),["rollback"]):(console.log(`[WARNING] EPG ${o.name} get failed!`),[void 0])}}));return{sources:t,epgs:e}}).then(t=>{console.log("[TASK] Write important files");let e=t.sources.map(n=>n.value),o=t.epgs.map(n=>n.value);st(),mt(),U("tvbox",$,"Channels"),Q($,e,V),lt($,e,V,o)}).then(async t=>{let e=await Promise.allSettled(xt.map(async o=>{console.log(`[TASK] Fetch DATA ${o.name}`);try{let[n,i,a]=await M(o);if(n&&i)return console.log(`Fetch DATA from ${o.name} finished, cost ${(parseInt(H.bigint().toString())-parseInt(a.toString()))/1e7} ms`),G(o.f_name,i),["normal"];{let s=await R(o);return s?(G(o.f_name,s),["rollback"]):(console.log(`[WARNING] DATA ${o.name} get failed!`),[void 0])}}catch{let i=await R(o);return i?(G(o.f_name,i),["rollback"]):(console.log(`[WARNING] DATA ${o.name} get failed!`),[void 0])}}));return{sources:t,movie:e}}).then(()=>{console.log("[TASK] Make custom sources"),St()}).catch(t=>{console.error(t)});
